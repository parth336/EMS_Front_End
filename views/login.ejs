<div class='d-flex justify-content-center align-items-center vh-100 loginPage'>
    <div class='p-3 rounded w-25 border loginForm'>
        <div class='text-warning' id="loginError">
            <% if (error) { %>
                <%= error.message %>
                    <% } %>
        </div>
        <h2>Login Page</h2>
        <form onsubmit="login(event)">
            <div class='mb-3'>
                <label htmlFor="email"><strong>Email:</strong></label>
                <input type="email" name='email' autoComplete='off' id="email" placeholder='Enter Email'
                    class='form-control rounded-0' />
            </div>
            <div class='mb-3'>
                <label htmlFor="password"><strong>Password:</strong></label>
                <input type="password" name='password' id="password" placeholder='Enter Password'
                    class='form-control rounded-0' />
            </div>
            <button class='btn btn-success w-100 rounded-0 mb-2'>Log in</button>
            <div class='mb-1'>
                <input type="checkbox" name="tick" id="tick" class='me-2' />
                <label htmlFor="password">Agree to terms & conditions</label>
            </div>
        </form>
    </div>
</div>

<script>
    var role = "<%= role %>"
    function login(e) {        
        e.preventDefault();
        let email = $("#email").val();
        let password = $("#password").val();
        let match = email.toLowerCase()
            .match(
                /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
            );
        if (match && password.length > 0) {
            $.post("/admin/login",
                {
                    email: email,
                    password: password,
                    role: role
                },
                function (data, status) {
                   if(data.error){
                    $("#loginError").html(data.message);
                   }else{
                    window.location.href = window.location.href.replace("/login","/dashboard");
                   }
                });
        } else {
            $("#loginError").html("Wrong Email or Password");
        }
        return false;
    }
</script>